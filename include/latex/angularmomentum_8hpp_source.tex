\hypertarget{angularmomentum_8hpp_source}{}\doxysection{angularmomentum.\+hpp}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*******************************************************************************************}}
\DoxyCodeLine{2 \textcolor{comment}{some of "{}operators.h"{} meathods implementation.}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{ref: [N. Zettili, “Quantum Mechanics, Concepts and Applications,” Wiley, Chichester, 2001.]}}
\DoxyCodeLine{5 \textcolor{comment}{}}
\DoxyCodeLine{6 \textcolor{comment}{by:  Mohammed Maher Abdelrahim Mohammed}}
\DoxyCodeLine{7 \textcolor{comment}{     UNIVERSITÀ DELLA CALABRIA, DIPARTIMENTO DI FISICA AND INFN-\/COSENZA}}
\DoxyCodeLine{8 \textcolor{comment}{     VIA P. BUCCI, CUBO 31 C, I-\/87036 COSENZA, ITALY}}
\DoxyCodeLine{9 \textcolor{comment}{     mohammed.maher@unical.it                                          }}
\DoxyCodeLine{10 \textcolor{comment}{*******************************************************************************************/}}
\DoxyCodeLine{11 \textcolor{comment}{//\#pragma once}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#ifndef QUANTAPLUS\_INCLUDE\_ANGULARMOMENTUM\_HPP}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#define QUANTAPLUS\_INCLUDE\_ANGULARMOMENTUM\_HPP}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#ifndef QUANTAPLUS\_INCLUDE\_ANGULARMOMENTUM\_HPP}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#error \_\_FILE\_\_ should only be included from angularmomentum.h.}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// ANGULARMOMENTUM\_H}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{20 \textcolor{comment}{ Check the physically valid (spin or orbital) angular m omentum }}
\DoxyCodeLine{21 \textcolor{comment}{ : True only if j is a nonnegative half-\/integer value}}
\DoxyCodeLine{22 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{23 \textcolor{keywordtype}{bool} validAngularMomentum(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& x)}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25     \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(2*x) -\/ 2*x == 0;}
\DoxyCodeLine{26 \}}
\DoxyCodeLine{27 \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{28 \textcolor{comment}{              Kronecker Delta:  δ[ij] =  1 => (if i=j) OR 0 => (otherwise).}}
\DoxyCodeLine{29 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{30 \textcolor{keywordtype}{double} KroneckerDelta(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& i, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j)}
\DoxyCodeLine{31 \{}
\DoxyCodeLine{32     \textcolor{keywordflow}{if}  (i==j)\{\textcolor{keywordflow}{return} (1);\}}
\DoxyCodeLine{33     \textcolor{keywordflow}{else} }
\DoxyCodeLine{34     \textcolor{keywordflow}{return} (0);}
\DoxyCodeLine{35 \}}
\DoxyCodeLine{36 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{37 \textcolor{comment}{//      commutation relation: [A,B] = A*B -\/ B*A}}
\DoxyCodeLine{38 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{39 \textcolor{keyword}{template}<\textcolor{keyword}{class} T> }
\DoxyCodeLine{40 Eigen::Matrix<T,Eigen::Dynamic,Eigen::Dynamic> }
\DoxyCodeLine{41     Commute( Eigen::Matrix<T, Eigen::Dynamic, Eigen::Dynamic>\& mt1, }
\DoxyCodeLine{42          Eigen::Matrix<T, Eigen::Dynamic, Eigen::Dynamic>\& mt2 )}
\DoxyCodeLine{43 \{  }
\DoxyCodeLine{44     \textcolor{keywordflow}{return} (mt1*mt2 -\/ mt2*mt1);}
\DoxyCodeLine{45 \}}
\DoxyCodeLine{46 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{47 \textcolor{comment}{//      compute structure constants}}
\DoxyCodeLine{48 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{49 \textcolor{keyword}{template} <\textcolor{keyword}{typename} U>}
\DoxyCodeLine{50 U StructureConstant( Eigen::Matrix<U,Eigen::Dynamic,Eigen::Dynamic>\& mt1, }
\DoxyCodeLine{51              Eigen::Matrix<U,Eigen::Dynamic,Eigen::Dynamic>\& mt2, }
\DoxyCodeLine{52              Eigen::Matrix<U,Eigen::Dynamic,Eigen::Dynamic>\& mt3 )}
\DoxyCodeLine{53 \{}
\DoxyCodeLine{54     U sum = \textcolor{keyword}{static\_cast<}U\textcolor{keyword}{>}(0.0);}
\DoxyCodeLine{55     \textcolor{keyword}{const} std::complex<double> I\{0.,1.\};}
\DoxyCodeLine{56 }
\DoxyCodeLine{57     Eigen::Matrix<U,3,3> cm, prod;}
\DoxyCodeLine{58     cm = Commute(mt2,mt3);}
\DoxyCodeLine{59     prod = mt1 * cm ;}
\DoxyCodeLine{60 }
\DoxyCodeLine{61     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<3; i++)}
\DoxyCodeLine{62     \{}
\DoxyCodeLine{63         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<(3); j++)}
\DoxyCodeLine{64         \{}
\DoxyCodeLine{65             \textcolor{keywordflow}{if}(i==j)}
\DoxyCodeLine{66             \{}
\DoxyCodeLine{67                 sum += prod(i,i);}
\DoxyCodeLine{68             \}}
\DoxyCodeLine{69         \}}
\DoxyCodeLine{70     \}}
\DoxyCodeLine{71     \textcolor{keywordflow}{return} std::real(-\/0.25*I*sum);}
\DoxyCodeLine{72 \}}
\DoxyCodeLine{73 \textcolor{comment}{//***************************************************************************** }}
\DoxyCodeLine{74 \textcolor{keyword}{const} \textcolor{keywordtype}{double} hBar = 1.; \textcolor{comment}{//6.58211899 * 1.e-\/16;}}
\DoxyCodeLine{75 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{76 \textcolor{comment}{//           Magnatic\_Quantum\_Number : m which is run from -\/j to j. (-\/j<= m <= j).                      }}
\DoxyCodeLine{77 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{78 \textcolor{keywordtype}{void} MagneticQuantumNumber(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{79 \{    }
\DoxyCodeLine{80     \textcolor{keywordtype}{double} spin = j;}
\DoxyCodeLine{81     \textcolor{keywordflow}{if}(validAngularMomentum(spin))}
\DoxyCodeLine{82     \{}
\DoxyCodeLine{83         \textcolor{keywordtype}{double} m[int(2*j+1)]=\{\};}
\DoxyCodeLine{84         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{85         \{       \textcolor{keywordflow}{if}(i==0)\{m[int(std::abs(j+i))]=0;\}}
\DoxyCodeLine{86             \textcolor{keywordflow}{else} m[int(std::abs(j+i))]=i;   }
\DoxyCodeLine{87         \}}
\DoxyCodeLine{88         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i =0;i<int(2*j+1);i++)}
\DoxyCodeLine{89         \{   \textcolor{keywordflow}{if}(i!=\textcolor{keywordtype}{int}(2*j+1)-\/1)\{}
\DoxyCodeLine{90             DecimalToFraction(m[i]); \textcolor{comment}{// [source utilities.h ]}}
\DoxyCodeLine{91             std::cout<<\textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{92             \}}
\DoxyCodeLine{93             \textcolor{keywordflow}{else} DecimalToFraction(m[i]);}
\DoxyCodeLine{94         \}}
\DoxyCodeLine{95         std::cout<<std::endl;}
\DoxyCodeLine{96     \}}
\DoxyCodeLine{97      }
\DoxyCodeLine{98     \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{99         std::cout<<\textcolor{stringliteral}{"{}spin ("{}}<<spin<<\textcolor{stringliteral}{"{} = "{}};}
\DoxyCodeLine{100         DecimalToFraction(spin); std::cout<<\textcolor{stringliteral}{"{}) is physically invalid!"{}}<<std::endl;}
\DoxyCodeLine{101     \}}
\DoxyCodeLine{102 \}}
\DoxyCodeLine{103 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{104 \textcolor{comment}{//      The square of the angular momentum J\string^2 :  }}
\DoxyCodeLine{105 \textcolor{comment}{//          <j',m'|J\string^2|j, m> = ℏ\string^2 j(j+1) δ[j'j] * δ[m'm].             }}
\DoxyCodeLine{106 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{107 \textcolor{keywordtype}{double} Jsqr(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j2, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m2)}
\DoxyCodeLine{108 \{}
\DoxyCodeLine{109     \textcolor{keywordflow}{return} hBar*hBar*j*(j+1) * KroneckerDelta(j1,j2) *KroneckerDelta(m1,m2);}
\DoxyCodeLine{110 \}}
\DoxyCodeLine{111 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{112 \textcolor{comment}{//      The x-\/component of the angular momentum operator J: }}
\DoxyCodeLine{113 \textcolor{comment}{//          Eq (5.70) of N. Zettili.                                   }}
\DoxyCodeLine{114 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{115 \textcolor{keywordtype}{double} Jx(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j1,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j2,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m2)}
\DoxyCodeLine{116 \{ }
\DoxyCodeLine{117     \textcolor{keywordtype}{double} res1,res2;}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     res1 = sqrt(j*(j+1)-\/m2*(m2+1))* KroneckerDelta(m1,m2+1);}
\DoxyCodeLine{120     res2 =   sqrt(j*(j+1)-\/m2*(m2-\/1))*  KroneckerDelta(m1,m2-\/1);}
\DoxyCodeLine{121     \textcolor{keywordflow}{return} hBar*0.5*(res1+res2)*KroneckerDelta(j1,j2);}
\DoxyCodeLine{122 \}}
\DoxyCodeLine{123 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{124 \textcolor{comment}{//      The y-\/component of the angular momentumo peratorJ: }}
\DoxyCodeLine{125 \textcolor{comment}{//          Eq (5.71) of N. Zettili.                                    }}
\DoxyCodeLine{126 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{127 std::complex<double>  Jy(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j1,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j2,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m2)}
\DoxyCodeLine{128 \{}
\DoxyCodeLine{129     std::complex<double> Im(0.,1.);}
\DoxyCodeLine{130     \textcolor{keywordtype}{double} res1,res2;}
\DoxyCodeLine{131 }
\DoxyCodeLine{132     res1 = sqrt(j*(j+1)-\/m2*(m2+1))* KroneckerDelta(m1,m2+1);}
\DoxyCodeLine{133     res2 =   sqrt(j*(j+1)-\/m2*(m2-\/1))*  KroneckerDelta(m1,m2-\/1);}
\DoxyCodeLine{134     \textcolor{comment}{//return hBar*(-\/0.5*Im)*(res1-\/res2)*KroneckerDelta(j1,j2);}}
\DoxyCodeLine{135     \textcolor{keywordflow}{return} hBar*(1./(2.*Im))*(res1-\/res2)*KroneckerDelta(j1,j2);}
\DoxyCodeLine{136 \}}
\DoxyCodeLine{137 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{138 \textcolor{comment}{//      The z-\/component of the angular momentum operator J: }}
\DoxyCodeLine{139 \textcolor{comment}{//           <j',m'|J\_Z|j, m> =  mℏ δ[j'j] * δ[m'm]. }}
\DoxyCodeLine{140 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{141 \textcolor{comment}{/*double Jz(const double \& j, const double \& j1, const double \& m1, const double \& j2, const double \& m2)}}
\DoxyCodeLine{142 \textcolor{comment}{\{}}
\DoxyCodeLine{143 \textcolor{comment}{    return hBar*m2 * KroneckerDelta(j1,j2) *KroneckerDelta(m1,m2);}}
\DoxyCodeLine{144 \textcolor{comment}{\}*/}}
\DoxyCodeLine{145 \textcolor{keywordtype}{double} Jz(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j2, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m2)}
\DoxyCodeLine{146 \{}
\DoxyCodeLine{147     \textcolor{keywordflow}{return} hBar*m2 * KroneckerDelta(j1,j2) *KroneckerDelta(m1,m2);}
\DoxyCodeLine{148 \}}
\DoxyCodeLine{149 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{150 \textcolor{comment}{//      The J+ angular momentum operator J: }}
\DoxyCodeLine{151 \textcolor{comment}{//          Eq (5.69) of N. Zettili.                                   }}
\DoxyCodeLine{152 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{153 \textcolor{keywordtype}{double} Jplus(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j1,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j2,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m2)}
\DoxyCodeLine{154 \{ }
\DoxyCodeLine{155     \textcolor{keywordtype}{double} res;}
\DoxyCodeLine{156     res = sqrt(j*(j+1)-\/m2*(m2+1))* KroneckerDelta(m1,m2+1);}
\DoxyCodeLine{157     \textcolor{keywordflow}{return} hBar*(res)*KroneckerDelta(j1,j2);}
\DoxyCodeLine{158 \}}
\DoxyCodeLine{159 \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{160 \textcolor{comment}{        The J-\/ angular momentum operator J: Eq (5.69) of N. Zettili.                                   }}
\DoxyCodeLine{161 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{162 \textcolor{keywordtype}{double} Jminus(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j1,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m1, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \& j2,\textcolor{keyword}{const} \textcolor{keywordtype}{double} \& m2)}
\DoxyCodeLine{163 \{ }
\DoxyCodeLine{164     \textcolor{keywordtype}{double} res;}
\DoxyCodeLine{165     res = sqrt(j*(j+1)-\/m2*(m2-\/1))* KroneckerDelta(m1,m2-\/1);}
\DoxyCodeLine{166     \textcolor{keywordflow}{return} hBar*(res)*KroneckerDelta(j1,j2);}
\DoxyCodeLine{167 \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{170 \textcolor{comment}{//      J-\/ Angular Momentum perator}}
\DoxyCodeLine{171 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{172 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{173 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::AngularMomentum\_JSquare}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{174 \textcolor{comment}{//AngularMomentum<T> AngularMomentum\_JSquare(const double \&j)}}
\DoxyCodeLine{175 \{}
\DoxyCodeLine{176     \textcolor{keyword}{const} \textcolor{keywordtype}{int} max =int(2*j+1);}
\DoxyCodeLine{177     std::complex<double> temarr[max*max]\{\};}
\DoxyCodeLine{178     \textcolor{keywordtype}{double} sp = j;}
\DoxyCodeLine{179   }
\DoxyCodeLine{180     \textcolor{keywordflow}{if}(validAngularMomentum(sp))}
\DoxyCodeLine{181     \{    }
\DoxyCodeLine{182             \textcolor{keywordtype}{double} M[max]=\{\};}
\DoxyCodeLine{183             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{184             \{}
\DoxyCodeLine{185                     M[std::abs(\textcolor{keywordtype}{int}(j+i))]=i;   }
\DoxyCodeLine{186             \}}
\DoxyCodeLine{187              }
\DoxyCodeLine{188             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<max;i++)}
\DoxyCodeLine{189             \{}
\DoxyCodeLine{190                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<max;k++)}
\DoxyCodeLine{191                     \{              }
\DoxyCodeLine{192                         temarr[k+(i*max)] = Jsqr(j,j,-\/M[i],j,-\/M[k]);}
\DoxyCodeLine{193                     \}        }
\DoxyCodeLine{194             \}}
\DoxyCodeLine{195         \}   }
\DoxyCodeLine{196     }
\DoxyCodeLine{197     \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{198         \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}the system has physically invalid spin!."{}});}
\DoxyCodeLine{199     \}}
\DoxyCodeLine{200     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} temp(max,max);}
\DoxyCodeLine{201     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<max; i++)}
\DoxyCodeLine{202     \{}
\DoxyCodeLine{203         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<max; j++)}
\DoxyCodeLine{204         \{}
\DoxyCodeLine{205                 temp(i,j)= temarr[j+i*max];}
\DoxyCodeLine{206         \}}
\DoxyCodeLine{207     \}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209     \textcolor{keywordflow}{return} temp;    }
\DoxyCodeLine{210 \}}
\DoxyCodeLine{211 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{212 \textcolor{comment}{//      Jx Angular Momentum perator}}
\DoxyCodeLine{213 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{214 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{215 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::AngularMomentum\_Jx}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{216 \textcolor{comment}{//AngularMomentum<T> AngularMomentum\_Jx(const double \&j)}}
\DoxyCodeLine{217 \{}
\DoxyCodeLine{218     \textcolor{keyword}{const} \textcolor{keywordtype}{int} max =int(2*j+1);}
\DoxyCodeLine{219     std::complex<double> temarr[max*max]\{\};}
\DoxyCodeLine{220     \textcolor{keywordtype}{double} sp = j;}
\DoxyCodeLine{221 }
\DoxyCodeLine{222     \textcolor{keywordflow}{if}(validAngularMomentum(sp))}
\DoxyCodeLine{223     \{    }
\DoxyCodeLine{224         \textcolor{keywordtype}{double} M[max]=\{\};}
\DoxyCodeLine{225         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{226         \{}
\DoxyCodeLine{227                 M[std::abs(\textcolor{keywordtype}{int}(j+i))]=i;   }
\DoxyCodeLine{228         \}}
\DoxyCodeLine{229          }
\DoxyCodeLine{230         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<max;i++)}
\DoxyCodeLine{231         \{}
\DoxyCodeLine{232                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<max;k++)}
\DoxyCodeLine{233                 \{   }
\DoxyCodeLine{234                 temarr[k+(i*max)] = Jx(j,j,-\/M[i],j,-\/M[k]);}
\DoxyCodeLine{235                 \}       }
\DoxyCodeLine{236 }
\DoxyCodeLine{237         \}   }
\DoxyCodeLine{238     \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     \textcolor{keywordflow}{else}}
\DoxyCodeLine{241     \{}
\DoxyCodeLine{242     \textcolor{comment}{//std::cout<<"{}the system has physically invalid spin!"{}<<std::endl;}}
\DoxyCodeLine{243         \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}the system has physically invalid spin!."{}});}
\DoxyCodeLine{244     \} }
\DoxyCodeLine{245     }
\DoxyCodeLine{246     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} temp(max,max);}
\DoxyCodeLine{247     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<max; i++)}
\DoxyCodeLine{248     \{}
\DoxyCodeLine{249         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<max; j++)}
\DoxyCodeLine{250         \{}
\DoxyCodeLine{251                 temp(i,j)= temarr[j+i*max];}
\DoxyCodeLine{252         \}}
\DoxyCodeLine{253     \}}
\DoxyCodeLine{254     \textcolor{keywordflow}{return} temp;      }
\DoxyCodeLine{255 \}}
\DoxyCodeLine{256 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{257 \textcolor{comment}{//      Jy Angular Momentum perator}}
\DoxyCodeLine{258 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{259 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{260 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::AngularMomentum\_Jy}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{261 \textcolor{comment}{//AngularMomentum<T> AngularMomentum\_Jy(const double \&j)}}
\DoxyCodeLine{262 \{}
\DoxyCodeLine{263     \textcolor{keyword}{const} \textcolor{keywordtype}{int} max =int(2*j+1);}
\DoxyCodeLine{264     std::complex<double> temarr[max*max]\{\};}
\DoxyCodeLine{265     \textcolor{keywordtype}{double} sp = j;}
\DoxyCodeLine{266 }
\DoxyCodeLine{267     \textcolor{keywordflow}{if}(validAngularMomentum(sp))}
\DoxyCodeLine{268     \{    }
\DoxyCodeLine{269         \textcolor{keywordtype}{double} M[max]=\{\};}
\DoxyCodeLine{270         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{271         \{}
\DoxyCodeLine{272                 M[std::abs(\textcolor{keywordtype}{int}(j+i))]=i;   }
\DoxyCodeLine{273         \}}
\DoxyCodeLine{274          }
\DoxyCodeLine{275         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<max;i++)}
\DoxyCodeLine{276         \{}
\DoxyCodeLine{277                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<max;k++)}
\DoxyCodeLine{278                 \{   }
\DoxyCodeLine{279                 temarr[k+(i*max)] = Jy(j,j,-\/M[i],j,-\/M[k]);}
\DoxyCodeLine{280                 \}   }
\DoxyCodeLine{281         \}}
\DoxyCodeLine{282     \}}
\DoxyCodeLine{283 }
\DoxyCodeLine{284     \textcolor{keywordflow}{else}}
\DoxyCodeLine{285     \{}
\DoxyCodeLine{286         \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}the system has physically invalid spin!."{}});}
\DoxyCodeLine{287     \}}
\DoxyCodeLine{288      }
\DoxyCodeLine{289     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} temp(max,max);}
\DoxyCodeLine{290     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<max; i++)}
\DoxyCodeLine{291     \{}
\DoxyCodeLine{292         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<max; j++)}
\DoxyCodeLine{293         \{}
\DoxyCodeLine{294                 temp(i,j)= temarr[j+i*max];}
\DoxyCodeLine{295         \}}
\DoxyCodeLine{296     \}}
\DoxyCodeLine{297 }
\DoxyCodeLine{298     \textcolor{keywordflow}{return} temp;       }
\DoxyCodeLine{299 \}}
\DoxyCodeLine{300 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{301 \textcolor{comment}{//      Jz Angular Momentum perator}}
\DoxyCodeLine{302 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{303 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{304 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::AngularMomentum\_Jz}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{305 \textcolor{comment}{//AngularMomentum<T> AngularMomentum\_Jz(const double \&j)}}
\DoxyCodeLine{306 \{}
\DoxyCodeLine{307     \textcolor{keyword}{const} \textcolor{keywordtype}{int} max =int(2*j+1);}
\DoxyCodeLine{308     std::complex<double> temarr[max*max]\{\};}
\DoxyCodeLine{309     \textcolor{keywordtype}{double} sp = j;}
\DoxyCodeLine{310 }
\DoxyCodeLine{311     \textcolor{keywordflow}{if}(validAngularMomentum(sp))}
\DoxyCodeLine{312     \{    }
\DoxyCodeLine{313         \textcolor{keywordtype}{double} M[max]=\{\};}
\DoxyCodeLine{314         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{315         \{       }
\DoxyCodeLine{316                 M[std::abs(\textcolor{keywordtype}{int}(j+i))]=-\/i;   }
\DoxyCodeLine{317         \}}
\DoxyCodeLine{318          }
\DoxyCodeLine{319         \textcolor{comment}{//for(int i=0;i<max;i++)}}
\DoxyCodeLine{320         \textcolor{comment}{//\{}}
\DoxyCodeLine{321                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<max;k++)}
\DoxyCodeLine{322                 \{       \textcolor{keywordflow}{if}( Jz(j,M[k],j,M[k]) ==0.)\{ temarr[k+(k*max)]=0.;\}}
\DoxyCodeLine{323                 \textcolor{comment}{//temarr[k+(i*max)] = Jz(M[i],j,M[k],j,M[i]);}}
\DoxyCodeLine{324                 \textcolor{keywordflow}{else} temarr[k+(k*max)] = Jz(j,M[k],j,M[k]);}
\DoxyCodeLine{325                 \}}
\DoxyCodeLine{326         \textcolor{comment}{//\} }}
\DoxyCodeLine{327     \}}
\DoxyCodeLine{328 }
\DoxyCodeLine{329     \textcolor{keywordflow}{else}}
\DoxyCodeLine{330     \{}
\DoxyCodeLine{331         \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}the system has physically invalid spin!."{}});}
\DoxyCodeLine{332     \} }
\DoxyCodeLine{333     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} temp(max,max);}
\DoxyCodeLine{334     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<max; i++)}
\DoxyCodeLine{335     \{}
\DoxyCodeLine{336         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<max; j++)}
\DoxyCodeLine{337         \{       }
\DoxyCodeLine{338                 temp(i,j)= temarr[j+i*max];}
\DoxyCodeLine{339                    \textcolor{comment}{// temp(i,j)= temarr[i+j];}}
\DoxyCodeLine{340         \}}
\DoxyCodeLine{341     \}}
\DoxyCodeLine{342 }
\DoxyCodeLine{343     \textcolor{keywordflow}{return} temp;      }
\DoxyCodeLine{344 \}}
\DoxyCodeLine{345 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{346 \textcolor{comment}{//      J+ Angular Momentum perator}}
\DoxyCodeLine{347 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{348 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{349 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::AngularMomentum\_JPlus}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{350 \textcolor{comment}{//AngularMomentum<T> AngularMomentum\_JPlus(const double \&j)}}
\DoxyCodeLine{351 \{}
\DoxyCodeLine{352     \textcolor{keyword}{const} \textcolor{keywordtype}{int} max =int(2*j+1);}
\DoxyCodeLine{353     std::complex<double> temarr[max*max]\{\};}
\DoxyCodeLine{354     \textcolor{keywordtype}{double} sp = j;}
\DoxyCodeLine{355 }
\DoxyCodeLine{356     \textcolor{keywordflow}{if}(validAngularMomentum(sp))}
\DoxyCodeLine{357     \{    }
\DoxyCodeLine{358         \textcolor{keywordtype}{double} M[max]=\{\};}
\DoxyCodeLine{359         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{360         \{}
\DoxyCodeLine{361                 M[std::abs(\textcolor{keywordtype}{int}(j+i))]=i;   }
\DoxyCodeLine{362         \}}
\DoxyCodeLine{363          }
\DoxyCodeLine{364         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<max;i++)}
\DoxyCodeLine{365         \{}
\DoxyCodeLine{366                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<max;k++)}
\DoxyCodeLine{367                 \{   }
\DoxyCodeLine{368                 temarr[k+(i*max)] = Jplus(j,j,-\/M[i],j,-\/M[k]);}
\DoxyCodeLine{369                 \}}
\DoxyCodeLine{370         \}}
\DoxyCodeLine{371     \}}
\DoxyCodeLine{372 }
\DoxyCodeLine{373     \textcolor{keywordflow}{else}}
\DoxyCodeLine{374     \{}
\DoxyCodeLine{375         \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}the system has physically invalid spin!."{}});}
\DoxyCodeLine{376     \} }
\DoxyCodeLine{377     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} temp(max,max);}
\DoxyCodeLine{378     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<max; i++)}
\DoxyCodeLine{379     \{}
\DoxyCodeLine{380         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<max; j++)}
\DoxyCodeLine{381         \{}
\DoxyCodeLine{382                 temp(i,j)= temarr[j+i*max];}
\DoxyCodeLine{383         \}}
\DoxyCodeLine{384     \}}
\DoxyCodeLine{385 }
\DoxyCodeLine{386     \textcolor{keywordflow}{return} temp;      }
\DoxyCodeLine{387 \}}
\DoxyCodeLine{388 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{389 \textcolor{comment}{//      J-\/ Angular Momentum perator}}
\DoxyCodeLine{390 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{391 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{392 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::AngularMomentum\_JMinus}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&j)}
\DoxyCodeLine{393 \textcolor{comment}{//AngularMomentum<T> AngularMomentum\_JMinus(const double \&j)}}
\DoxyCodeLine{394 \{}
\DoxyCodeLine{395     \textcolor{keyword}{const} \textcolor{keywordtype}{int} max =int(2*j+1);}
\DoxyCodeLine{396     std::complex<double> temarr[max*max]\{\};}
\DoxyCodeLine{397     \textcolor{keywordtype}{double} sp = j;}
\DoxyCodeLine{398 }
\DoxyCodeLine{399     \textcolor{keywordflow}{if}(validAngularMomentum(sp))}
\DoxyCodeLine{400     \{    }
\DoxyCodeLine{401         \textcolor{keywordtype}{double} M[max]=\{\};}
\DoxyCodeLine{402         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i =-\/j; i<=j; i++)}
\DoxyCodeLine{403         \{}
\DoxyCodeLine{404             M[std::abs(\textcolor{keywordtype}{int}(j+i))]=i;   }
\DoxyCodeLine{405         \}}
\DoxyCodeLine{406          }
\DoxyCodeLine{407         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<max;i++)}
\DoxyCodeLine{408         \{}
\DoxyCodeLine{409             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<max;k++)}
\DoxyCodeLine{410             \{     }
\DoxyCodeLine{411                     temarr[k+(i*max)] = Jminus(j,j,-\/M[i],j,-\/M[k]);}
\DoxyCodeLine{412             \}        }
\DoxyCodeLine{413         \}}
\DoxyCodeLine{414     \}}
\DoxyCodeLine{415 }
\DoxyCodeLine{416     \textcolor{keywordflow}{else}}
\DoxyCodeLine{417     \{}
\DoxyCodeLine{418         \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}the system has physically invalid spin!."{}});}
\DoxyCodeLine{419     \} }
\DoxyCodeLine{420     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} temp(max,max);}
\DoxyCodeLine{421     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<max; i++)}
\DoxyCodeLine{422     \{}
\DoxyCodeLine{423         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<max; j++)}
\DoxyCodeLine{424         \{}
\DoxyCodeLine{425                 temp(i,j)= temarr[j+i*max];}
\DoxyCodeLine{426         \}}
\DoxyCodeLine{427     \}}
\DoxyCodeLine{428 }
\DoxyCodeLine{429     \textcolor{keywordflow}{return} temp;     }
\DoxyCodeLine{430 \}}
\DoxyCodeLine{431 }
\DoxyCodeLine{432 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{433 \textcolor{comment}{//}}
\DoxyCodeLine{434 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{435 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{436 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} MatrixExp(\mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \&A)\{}
\DoxyCodeLine{437 }
\DoxyCodeLine{438 \textcolor{keywordflow}{return}  A.exp();}
\DoxyCodeLine{439 \}}
\DoxyCodeLine{440 }
\DoxyCodeLine{441 \textcolor{comment}{/*template <typename T>}}
\DoxyCodeLine{442 \textcolor{comment}{Eigen::Matrix<T,Eigen::Dynamic,Eigen::Dynamic> MatrixExp(Eigen::Matrix<T,Eigen::Dynamic,Eigen::Dynamic> \&A, Eigen::Matrix<T,Eigen::Dynamic,Eigen::Dynamic> \&V )\{}}
\DoxyCodeLine{443 \textcolor{comment}{}}
\DoxyCodeLine{444 \textcolor{comment}{return  A.exp()*V;}}
\DoxyCodeLine{445 \textcolor{comment}{\}*/}}
\DoxyCodeLine{446 }
\DoxyCodeLine{447 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{448 \textcolor{comment}{//       }}
\DoxyCodeLine{449 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{450 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{451 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>::RotationByAngle}}(\textcolor{keyword}{const} std::string\& dir, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&a)}
\DoxyCodeLine{452 \textcolor{comment}{//AngularMomentum<T> RotationByAngle(const std::string\& dir, const double \&a)}}
\DoxyCodeLine{453 \{}
\DoxyCodeLine{454     \textcolor{keyword}{const} \textcolor{keywordtype}{double} spin= 3./2.;}
\DoxyCodeLine{455     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} res;}
\DoxyCodeLine{456     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<std::complex<double>}}> J;}
\DoxyCodeLine{457     \textcolor{keywordflow}{if}(dir == \textcolor{stringliteral}{"{}x"{}})}
\DoxyCodeLine{458     \{}
\DoxyCodeLine{459         J = J.\mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum_a621a12db69b9b1859666a8f9a31b9f2e}{AngularMomentum\_Jx}}(spin);}
\DoxyCodeLine{460     \}}
\DoxyCodeLine{461 }
\DoxyCodeLine{462     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dir==\textcolor{stringliteral}{"{}y"{}})\{}
\DoxyCodeLine{463         J = J.\mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum_a2f82e75c2cc3497cb464b8e3d0cca471}{AngularMomentum\_Jy}}(spin);}
\DoxyCodeLine{464     \}}
\DoxyCodeLine{465 }
\DoxyCodeLine{466     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(dir == \textcolor{stringliteral}{"{}z"{}})}
\DoxyCodeLine{467     \{}
\DoxyCodeLine{468         J = J.\mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum_a220216f8f33e3d3df959e3e29660148f}{AngularMomentum\_Jz}}(spin);}
\DoxyCodeLine{469     \}}
\DoxyCodeLine{470     \textcolor{comment}{//std::complex<double> i(0.,1.);}}
\DoxyCodeLine{471     res = -\/1.*std::complex<double>(0.,1.)*a*J;}
\DoxyCodeLine{472     \textcolor{keywordflow}{return} MatrixExp(res);}
\DoxyCodeLine{473 \}}
\DoxyCodeLine{474 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{475 \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} RotationByAngle(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&a, \textcolor{keyword}{const} \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}}\& mat)}
\DoxyCodeLine{476 \{}
\DoxyCodeLine{477      }
\DoxyCodeLine{478     \mbox{\hyperlink{classQuantaPlus_1_1AngularMomentum}{AngularMomentum<T>}} res;}
\DoxyCodeLine{479      }
\DoxyCodeLine{480     res = -\/1.*std::complex<double>(0.,1.)*a*mat;}
\DoxyCodeLine{481     \textcolor{keywordflow}{return} MatrixExp(res);}
\DoxyCodeLine{482 \}}
\DoxyCodeLine{483 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{484 \textcolor{comment}{//      Wigner functions }}
\DoxyCodeLine{485 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{486 \textcolor{comment}{/*template <class T>}}
\DoxyCodeLine{487 \textcolor{comment}{ AngularMomentum<T> AngularMomentum<T>::RotationByAngle(const std::string\& dir, const double \&a)}}
\DoxyCodeLine{488 \textcolor{comment}{\{\}*/}}
\DoxyCodeLine{489 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// ANGULARMOMENTUM\_HPP}}

\end{DoxyCode}
